---
title: "blenderで炎と煙を出す"
date: 2022-09-17T20:37:11+09:00
draft: true
tag: [blender, study]
---


液体でなくて、煙や炎も、液体と同様に物理演算でできる。    
いろいろ癖があって苦労したけどできた。  
煙の色と、炎の強さを時間によって変えながらやってみた。

{{< video src="/videos/blender_flame.mp4" type="video/mp4" >}}

煙と炎が出てくるところと、煙が流れる範囲を囲った場所に作成したオブジェクトに、物理演算プロパティを設定するところは同じ。

煙が流れる範囲を囲った場所に作成したオブジェクトのShadingの画面に移って、マテリアル出力ののボリュームにプリンシプルボリュームを設定した。プリンシプルボリュームのカラーと黒体の強度、チントを調整すると煙と炎ができる。

色を変化させるところはカラーランプを使った。赤→青→緑→赤と変化させるようにして、120フレームごとに1週するように係数には `frame%120/120` という設定をいれた。frameをいれた計算式は一度 `#frame` という設定を入れてからでないとできなかった。多分良い方法がある。

炎の大きさを変えるところは、黒体の強度に `0.8+0.5*cos(frame/3.14)` という設定を入れた。cosとかも使えるみたいだった。

煙の設定がややこしかった。ワイヤーフレームモードや、ソリッドモードで煙と炎が表示されるが、レンダリングすると、ドメインを設定したオブジェクトがそのままカメラに映る状態になっていた。マテリアル出力でサーフェスが設定されてしまっているので映るようだった。マテリアル出力のボリュームが煙や炎の出力をさすようだった。Shadingの画面でマテリアル出力のボリュームにプリンシプルボリュームを設定したら煙が出るようになる、炎はプリンシプルボリュームの黒体の強度を調整すると見える。物理演算のプロパティのところでも煙の色という設定値があるけどどういう効果があるものか不明だった、プレビューのときには色が変化してた。