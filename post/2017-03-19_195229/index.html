
<!DOCTYPE html>
<html lang="ja">
<head>

  
  <meta charset="UTF-8">
  <title>
    IPAM DCIM ツールの netbox を試してみる | よもぎさんのへや
  </title>


  
  <meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1">


  
  <link rel="stylesheet" href="/article/css/sanitize.css">
  <link rel="stylesheet" href="/article/css/responsive.css">
  <link rel="stylesheet" HREF="/article/css/highlight_monokai.css">
  <link rel="stylesheet/less" href="/article/css/theme.less">
  <link rel="stylesheet" href="/article/css/custom.css">


  
  <script src="/article/js/less.js" type="text/javascript"></script>


</head>



<body>
<div class="container">

  
  <header role="banner">
    <div class="row gutters">
      <div id="site-title" class="col span_6">
        <h1><a href="/article/">よもぎさんのへや</a></h1>
        <h2>たなからくさだいふく</h2>
      </div>
      <div id="social" class="col span_6">
        <ul>
          <li><a href="https://twitter.com/YOMOGItanpop" target="_blank">Twitter</a></li>
          
          <li><a href="https://github.com/yomogitaro" target="_blank">GitHub</a></li>
        </ul>
      </div>
    </div>
  </header>


  
  <main id="single" role="main">
    <div class="article-header">
      <h1>IPAM DCIM ツールの netbox を試してみる</h1>
      <div class="meta">
        Mar 19, 2017 &nbsp;
        
      </div>
    </div>
    <article>
      

<p>ちょっと前に<a href="https://netbox.readthedocs.io/en/latest/">netbox</a>というツールが良いと教えてもらったので試してみる。自分がためしたバージョンは v1.9.2。
<a href="https://github.com/digitalocean/netbox">netbox</a> 自体は、 Django で書かれた Web アプリケーション。 <a href="https://github.com/digitalocean/go-netbox">go-netbox</a> という golang で書かれた API クライアントもある。</p>

<p>netbox のリポジトリに <code>docker-compose.yml</code> ファイルがあるのでこれを使ってたてていろいろ netbox と go-netbox を触ってみた。
<a href="http://netbox.readthedocs.io/en/stable/installation/docker/">http://netbox.readthedocs.io/en/stable/installation/docker/</a></p>

<h1 id="web-ui-から一通りつかってみる">Web UI から一通りつかってみる</h1>

<p>ログインするとダッシュボード画面が出てくる。
地域を管理する機能、DCIMとしての機能、IPAMとしての機能、エンドポイント間のリンクを管理する機能、パスワードなどの機密情報を管理する機能で分かれている。
<img src="/article/images/netbox002.png" alt="" /></p>

<p>DCIM は使ったことがないので何ができると良いのかはよくわかっていない。
機器の配置を決めてラック図を作ったり、
製造元やシリアルナンバーなどの機器の情報を管理できるみたいだった。</p>

<p>IPAM としては、 VLAN やサブネット、IP が管理できた。
Tenant や Site と紐付けることができたるので、目的の情報に到達しやすそう。
Site は親子関係をつくって階層分けできたのも良かった。
IP や VLAN などの登録は、 csv から一括登録するなどの方法が用意されていた。</p>

<p>管理者画面の <a href="https://netbox.readthedocs.io/en/stable/data-model/extras/">Extra</a> というところで、
Custom Field の追加や、 Export Template の追加は試せた。
Export Template で Custom Field を指定できなかったりしたけど一通り動いた。
外部からグラフを表示する機能や、トポロジマップの機能もあるようだった。</p>

<h1 id="api-について">API について</h1>

<p><code>/api/docs/</code> などを見に行くと Swagger UI で API の一覧が見られる。
<code>django-rest-swagger</code> で Swagger のドキュメントを生成しているみたいだった。
基本的に GET の API しか用意されていないみたいだった。
IPAM 系は GET の API しか存在しなかった。</p>

<h1 id="go-netbox-試してみる">go-netbox 試してみる</h1>

<p>golang の API クライアントの go-netbox を使ってみた。
IP の一覧を取得するコードを適当に作った。</p>

<pre><code class="language-go">package main

import (
    &quot;fmt&quot;
    &quot;github.com/digitalocean/go-netbox&quot;
)

func main() {
    c, _ := netbox.NewClient(&quot;http://localhost&quot;, nil);
    ips, _ := c.IPAM.ListIPAddresses(nil)
    for _, ip := range ips{
        marshaled, _ := ip.MarshalJSON()
        fmt.Println(string(marshaled));
    }
}
</code></pre>

<p>出力はこんな感じになる。</p>

<pre><code>{&quot;id&quot;:1,&quot;family&quot;:4,&quot;address&quot;:&quot;192.168.0.3/32&quot;,&quot;vrf&quot;:null,&quot;interface&quot;:null,&quot;description&quot;:&quot;&quot;,&quot;nat_inside&quot;:null,&quot;nat_outside&quot;:null}
{&quot;id&quot;:2,&quot;family&quot;:4,&quot;address&quot;:&quot;192.168.0.4/32&quot;,&quot;vrf&quot;:null,&quot;interface&quot;:null,&quot;description&quot;:&quot;&quot;,&quot;nat_inside&quot;:null,&quot;nat_outside&quot;:null}
{&quot;id&quot;:3,&quot;family&quot;:4,&quot;address&quot;:&quot;192.168.0.5/32&quot;,&quot;vrf&quot;:null,&quot;interface&quot;:null,&quot;description&quot;:&quot;&quot;,&quot;nat_inside&quot;:null,&quot;nat_outside&quot;:null}
{&quot;id&quot;:4,&quot;family&quot;:4,&quot;address&quot;:&quot;192.168.0.13/32&quot;,&quot;vrf&quot;:null,&quot;interface&quot;:null,&quot;description&quot;:&quot;&quot;,&quot;nat_inside&quot;:null,&quot;nat_outside&quot;:null}
{&quot;id&quot;:5,&quot;family&quot;:4,&quot;address&quot;:&quot;192.168.0.14/32&quot;,&quot;vrf&quot;:null,&quot;interface&quot;:null,&quot;description&quot;:&quot;&quot;,&quot;nat_inside&quot;:null,&quot;nat_outside&quot;:null}
{&quot;id&quot;:6,&quot;family&quot;:4,&quot;address&quot;:&quot;192.168.0.15/32&quot;,&quot;vrf&quot;:null,&quot;interface&quot;:null,&quot;description&quot;:&quot;&quot;,&quot;nat_inside&quot;:null,&quot;nat_outside&quot;:null}
</code></pre>

<h1 id="試している時にとったいろいろなキャプチャ">試している時にとったいろいろなキャプチャ</h1>

<h4 id="ipam-は-get-系の-api-しかなくて残念">IPAM は GET 系の API しかなくて残念</h4>

<p><img src="/article/images/netbox001.png" alt="GET 系の API しかなくて残念の図" /></p>

<h4 id="ラック図がみれる">ラック図がみれる</h4>

<p><img src="/article/images/netbox003.png" alt="" /></p>

<h3 id="ある-site-の-ip-を一つ取ろうと思った時の操作">ある Site の IP を一つ取ろうと思った時の操作</h3>

<h4 id="site-を選んで">Site を選んで、</h4>

<p><img src="/article/images/netbox004.png" alt="" /></p>

<h4 id="prefix-を選んで">Prefix を選んで、</h4>

<p><img src="/article/images/netbox005.png" alt="" /></p>

<h4 id="add-ip-を押して">Add IP を押して、</h4>

<p><img src="/article/images/netbox006.png" alt="" /></p>

<h4 id="ip-を取る">IP を取る</h4>

<p><img src="/article/images/netbox007.png" alt="" /></p>

<h4 id="追加する-ip-は-複数同時に指定したりできる">追加する IP は、複数同時に指定したりできる</h4>

<p><img src="/article/images/netbox008.png" alt="" /></p>

<h4 id="csv-形式で大量に追加することもできる">csv 形式で大量に追加することもできる</h4>

<p><img src="/article/images/netbox009.png" alt="" /></p>

<h3 id="extra-を試した">Extra を試した</h3>

<h4 id="custom-field-追加">Custom Field 追加</h4>

<p><img src="/article/images/netbox010.png" alt="" /></p>

<h4 id="custom-field-ができた">Custom Field ができた</h4>

<p><img src="/article/images/netbox011.png" alt="" /></p>

<h4 id="export-template-追加">Export Template 追加</h4>

<p><img src="/article/images/netbox012.png" alt="" /></p>

<h4 id="export-template-出力">Export Template 出力</h4>

<pre><code>- address: 192.168.0.3/32
  status: 2
- address: 192.168.0.4/32
  status: 2
- address: 192.168.0.5/32
  status: 2
- address: 192.168.0.13/32
  status: 2
- address: 192.168.0.14/32
  status: 2
- address: 192.168.0.15/32
  status: 2
</code></pre>

    </article>
    


<script type="text/javascript">
     
    var disqus_shortname = '';

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </main>


  
  <footer role="contentinfo">
    <div style="text-align:center;">
      <img src="https://s.gravatar.com/avatar/4d1410a9d92bd52625d4de8a51c389b7?s=80" width="64" height="64"><br>
      Written by YOMOGITARO
    </div>
  </footer>


</div>

<script src="/article/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



</body>
</html>

